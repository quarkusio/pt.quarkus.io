<!DOCTYPE html>
<html lang="pt">







<head>
  <title>AWS Lambda with Quarkus REST, Undertow, or Reactive Routes - 3.20 - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/3.20/guides/aws-lambda-http" />
  <meta property="og:title" content="AWS Lambda with Quarkus REST, Undertow, or Reactive Routes - 3.20" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/aws-lambda-http">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/version/3.20/guides/aws-lambda-http" />
  
  <link rel="alternate" hreflang="pt-br" href="https://pt.quarkus.io/version/3.20/guides/aws-lambda-http" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/version/3.20/guides/aws-lambda-http" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/version/3.20/guides/aws-lambda-http" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/version/3.20/guides/aws-lambda-http" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  


<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io/version/3.20/guides/aws-lambda-http">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="#">Why<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">O QUE É QUARKUS?</a></li>
          <li><a href="/developer-joy" class="">ALEGRIA DO DESENVOLVEDOR</a></li>
          <li><a href="/performance" class="">PERFORMANCE</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVO</a></li>
          <li><a href="/standards" class="">PADRÕES</a></li>
          <li><a href="/versatility" class="">VERSATILITY</a></li>
          <li><a href="/container-first" class="">CONTAINER PRIMEIRO</a></li>
          <li><a href="/spring" class="">USING SPRING?</a></li>
          <li class="tertiarydropdown">
            <span href="#">AI<i class="fas fa-chevron-down"></i></span>
            <ul class="tertiarymenu">
              <li><a href="/ai" class="">AI OVERVIEW</a></li>
              <li><a href="/java-for-ai" class="">JAVA FOR AI</a></li>
              <li><a href="/quarkus-for-ai" class="">WHY QUARKUS FOR AI</a></li>
              <li><a href="/ai-blueprints" class="">AI BLUEPRINTS</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Learn<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">COMEÇAR</a></li>
          <li><a href="/guides" class="active">DOCUMENTAÇÃO</a></li>
          <li><a href="/userstories/" class="">USER STORIES</a></li>  
          <li><a href="/qtips" class="">VÍDEOS "Q" TIP</a></li>          
          <li><a href="/books" class="">LIVROS</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="#">Extensions<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
<li><a href="https://quarkus.io/extensions/" class="">PROCURAR EXTENSÕES</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">USAR
EXTENSÕES</a></li>
          <li><a href="/guides/writing-extensions" class="">CRIAR
EXTENSÕES</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">COMPARTILHE EXTENSÕES</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Community<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">SUPORTE</a></li>
          <li><a href="/blog" class="">BLOG</a></li>
          <li><a href="/discussion" class="">DISCUSSÃO</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">PODCAST</a></li>
          <li><a href="/events" class="">EVENTOS</a></li>
          <li><a href="/newsletter" class="">BOLETIM INFORMATIVO</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ROADMAP</a></li>
          <li><a href="/benefactors" class="">BENEFACTORS</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary white">COMECE
A CODIFICAR</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/3.20/guides/aws-lambda-http" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/version/3.20/guides/aws-lambda-http">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/version/3.20/guides/aws-lambda-http">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/3.20/guides/aws-lambda-http">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/3.20/guides/aws-lambda-http">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas
fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    





<section class="full-width-version-bg flexfilterbar guides">
    <div class="guideflexcontainer">
        <div class="docslink">
            <a class="returnlink" href="/version/3.20/guides/"> Voltar aos Guias</a>
        </div>
        <div class="flexlabel">
            <label>Por Versão</label>
        </div>
        <div class="guidepulldown version">
            <select id="guide-version-dropdown">
                
                
                
                <option value="main" >Main - SNAPSHOT</option>
                
                
                
                <option value="latest" >3.28.5 - Latest</option>
                
                
                
                <option value="3.27" >3.27</option>
                
                
                
                <option value="3.20" selected>3.20</option>
                
                
                
                <option value="3.15" >3.15</option>
                
                
                
                <option value="3.8" >3.8</option>
                </select>
        </div>
    </div>
</section>

<div class="guide">
    <div class="grid-wrapper">
        <div class="grid__item width-8-12 width-12-12-m">
            <h1 class="text-caps">AWS Lambda with Quarkus REST, Undertow, or Reactive Routes </h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>With Quarkus you can deploy your favorite Java HTTP frameworks as AWS Lambda&#8217;s using either the <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api.html">AWS Gateway HTTP API</a>
or <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-rest-api.html">AWS Gateway REST API</a>.  This means that you can deploy your microservices written with Quarkus REST (our Jakarta REST implementation),
Undertow (servlet), Reactive Routes, <a href="funqy-http">Funqy HTTP</a> or any other Quarkus HTTP framework as an AWS Lambda.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You should only use single HTTP framework together with AWS Lambda extension to avoid unexpected conflicts and errors.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can deploy your Lambda as a pure Java jar, or you can compile your project to a native image and deploy that for a smaller
memory footprint and startup time.  Our integration also generates SAM deployment files that can be consumed by <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/what-is-sam.html">Amazon&#8217;s SAM framework</a>.</p>
</div>
<div class="paragraph">
<p>Quarkus has a different extension for each Gateway API.  The HTTP Gateway API is implemented within the <code>quarkus-amazon-lambda-http</code> extension.
The REST Gateway API is implemented within the <code>quarkus-amazon-lambda-rest</code> extension.  If you are confused on which Gateway product to use,
Amazon has a <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-vs-rest.html">great guide</a> to help you navigate this decision.</p>
</div>
<div class="paragraph">
<p>Tal como a maioria das extensões Quarkus, as extensões Quarkus AWS Lambda HTTP/REST suportam Live Coding.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Essa tecnologia é considerada preview.</p>
</div>
<div class="paragraph">
<p>In <em>preview</em>, backward compatibility and presence in the ecosystem is not guaranteed.
Specific improvements might require changing configuration or APIs, and plans to become <em>stable</em> are under way.
Feedback is welcome on our <a href="https://groups.google.com/d/forum/quarkus-dev">mailing list</a> or as issues in our <a href="https://github.com/quarkusio/quarkus/issues">GitHub issue tracker</a>.</p>
</div>
<div class="paragraph">
<p>Para obter uma lista completa de possíveis status, consulte nosso <a href="https://quarkus.io/faq/#what-are-the-extension-statuses">FAQ</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Pré-requisitos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para concluir este guia, você precisa:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mais ou menos 30 minutes</p>
</li>
<li>
<p>Um IDE</p>
</li>
<li>
<p>JDK 17+ instalado com <code>JAVA_HOME</code> configurado corretamente</p>
</li>
<li>
<p>Apache Maven 3.9.9</p>
</li>
<li>
<p>Opcionalmente, o <a href="cli-tooling">Quarkus CLI</a> se você quiser usá-lo</p>
</li>
<li>
<p>Opcionalmente, Mandrel ou GraalVM instalado e <a href="building-native-image#configuring-graalvm">configurado apropriadamente</a> se você quiser criar um executável nativo (ou Docker se você usar uma compilação de contêiner nativo)</p>
</li>
<li>
<p><a href="https://aws.amazon.com">Uma conta Amazon AWS</a></p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html">CLI DO AWS SAM</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started"><a class="anchor" href="#getting-started"></a>Primeiros passos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide walks you through generating an example Java project via a Maven archetype.  Later on, it walks through the structure
of the project so you can adapt any existing projects you have to use AWS Lambda.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-aws-bits"><a class="anchor" href="#installing-aws-bits"></a>Instalando os componentes AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Installing all the AWS bits is probably the most difficult thing about this guide.  Make sure that you follow all the steps
for installing AWS SAM CLI.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-maven-deployment-project"><a class="anchor" href="#creating-the-maven-deployment-project"></a>Criando o Maven Deployment Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Crie o projeto Quarkus AWS Lambda Maven utilizando o nosso Arquétipo Maven.</p>
</div>
<div class="paragraph">
<p>Se você quiser utilizar a API HTTP do AWS Gateway, gere o seu projeto com este script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn archetype:generate \
       -DarchetypeGroupId=io.quarkus \
       -DarchetypeArtifactId=quarkus-amazon-lambda-http-archetype \
       -DarchetypeVersion=3.20.3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se você quiser utilizar a API REST do AWS Gateway, gere o seu projeto com este script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn archetype:generate \
       -DarchetypeGroupId=io.quarkus \
       -DarchetypeArtifactId=quarkus-amazon-lambda-rest-archetype \
       -DarchetypeVersion=3.20.3</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build-and-deploy"><a class="anchor" href="#build-and-deploy"></a>Build e Deploy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Compile o projeto:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will compile the code and run the unit tests included within the generated project.
Unit testing is the same as any other Java project and does not require running on Amazon.  Quarkus dev mode is also
available with this extension.</p>
</div>
<div class="paragraph">
<p>If you want to build a native executable, make sure you have GraalVM installed correctly and just add a <code>native</code> property
to the build</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are building on a non-Linux system, you will need to also pass in a property instructing quarkus to use a Docker build as Amazon
Lambda requires Linux binaries.  You can do this by passing <code>-Dquarkus.native.container-build=true</code> to your build command.
This requires you to have Docker installed locally, however.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>According to the <a href="https://docs.aws.amazon.com/linux/al2023/ug/system-requirements.html#system-requirements-cpu-x86-64">AWS documentation</a>, AL2023
x86-64 binaries are built for the x86-64-<strong>v2</strong> revision of the x86-64 architecture.
In Quarkus, the default value of <a href="building-native-image#quarkus-core_quarkus-native-march">quarkus.native.march</a> is x86-64-<strong>v3</strong>.
This could cause
<a href="https://repost.aws/questions/QUBVnl6hn-Toe1LPr1qjOXzg/lambda-failed-with-java-compiled-into-machine-code">issues</a> if AWS Lambda provisions older
hardware.
To maximize Lambda compatibility, you can set <code>quarkus.native.march</code> to <code>x86-64-v2</code>.
See the <a href="native-reference#work-around-missing-cpu-features">Native Reference</a> guide for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native --no-tests -Dquarkus.native.container-build=true
# The --no-tests flag is required only on Windows and macOS.</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative -DskipTests -Dquarkus.native.container-build=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extra-build-generated-files"><a class="anchor" href="#extra-build-generated-files"></a>Arquivos extras gerados pela compilação</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you run the build, there are a few extra files generated by the Quarkus lambda extension you are using.  These files
are in the build directory:  <code>target/</code> for Maven, <code>build/</code> for Gradle.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>function.zip</code> - arquivo de deployment lambda</p>
</li>
<li>
<p><code>sam.jvm.yaml</code> - script de deployment do sam cli</p>
</li>
<li>
<p><code>sam.native.yaml</code> - script de deployment do sam cli para nativo</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="live-coding-and-simulating-aws-lambda-environment-locally"><a class="anchor" href="#live-coding-and-simulating-aws-lambda-environment-locally"></a>Live Coding e simulação local do ambiente AWS Lambda</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In dev and test mode, Quarkus will start a mock AWS Lambda event server
that will convert HTTP requests to the corresponding API Gateway event types and post them to the underlying
Quarkus HTTP lambda environment for processing.  This simulates the AWS Lambda environment
as much as possible locally without requiring tools like Docker and SAM CLI.</p>
</div>
<div class="paragraph">
<p>When using Quarkus Dev Mode just invoke HTTP requests on <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code>
as you normally would when testing your REST endpoints.  This request will hit the Mock Event Server and will
be converted to the API Gateway json message that is consumed by the Quarkus Lambda Poll loop.</p>
</div>
<div class="paragraph">
<p>For testing, Quarkus starts up a separate Mock Event server under port 8081.  The default port for Rest Assured is
automatically set to 8081 by Quarkus, so you don&#8217;t have to worry about setting this up.</p>
</div>
<div class="paragraph">
<p>If you want to simulate more complex
API Gateway events in your tests, then manually do an HTTP POST to <code><a href="http://localhost:8080/_lambda_" class="bare">http://localhost:8080/_lambda_</a></code> (port 8081 in test mode) with
the raw API Gateway json events.  These events will be placed directly on the Quarkus Lambda poll loop
for processing.  Here&#8217;s an example of that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static io.restassured.RestAssured.given;
import static org.hamcrest.CoreMatchers.equalTo;

import com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPEvent;

import io.quarkus.test.junit.QuarkusTest;

@QuarkusTest
public class AmazonLambdaSimpleTestCase {
    @Test
    public void testJaxrsCognitoJWTSecurityContext() throws Exception {
        APIGatewayV2HTTPEvent request = request("/security/username");
        request.getRequestContext().setAuthorizer(new APIGatewayV2HTTPEvent.RequestContext.Authorizer());
        request.getRequestContext().getAuthorizer().setJwt(new APIGatewayV2HTTPEvent.RequestContext.Authorizer.JWT());
        request.getRequestContext().getAuthorizer().getJwt().setClaims(new HashMap&lt;&gt;());
        request.getRequestContext().getAuthorizer().getJwt().getClaims().put("cognito:username", "Bill");

        given()
                .contentType("application/json")
                .accept("application/json")
                .body(request)
                .when()
                .post("/_lambda_")
                .then()
                .statusCode(200)
                .body("body", equalTo("Bill"));
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>O exemplo acima simula o envio de uma entidade Cognito com um pedido HTTP para o seu HTTP Lambda.</p>
</div>
<div class="paragraph">
<p>If you want to hand code raw events for the AWS HTTP API, the AWS Lambda library has the request event type which is
<code>com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPEvent</code> and the response event type
of <code>com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPResponse</code>.  This corresponds
to the <code>quarkus-amazon-lambda-http</code> extension and the AWS HTTP API.</p>
</div>
<div class="paragraph">
<p>If you want to hand code raw events for the AWS REST API, Quarkus has its own implementation:  <code>io.quarkus.amazon.lambda.http.model.AwsProxyRequest</code>
and <code>io.quarkus.amazon.lambda.http.model.AwsProxyResponse</code>.  This corresponds
to <code>quarkus-amazon-lambda-rest</code> extension and the AWS REST API.</p>
</div>
<div class="paragraph">
<p>O servidor de eventos simulado também é iniciado para os testes do <code>@QuarkusIntegrationTest</code> , portanto, também funcionará com binários nativos. Tudo isso oferece funcionalidade semelhante ao teste local da SAM CLI, sem a sobrecarga do Docker.</p>
</div>
<div class="paragraph">
<p>Por fim, se a porta 8080 ou a porta 8081 não estiver disponível em seu computador, você poderá modificar as portas dos modos dev e test com application.properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">quarkus.lambda.mock-event-server.dev-port=8082
quarkus.lambda.mock-event-server.test-port=8083</code></pre>
</div>
</div>
<div class="paragraph">
<p>Um valor de porta zero resultará numa porta atribuída aleatoriamente.</p>
</div>
<div class="paragraph">
<p>Para desativar o mock event server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">quarkus.lambda.mock-event-server.enabled=false</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simulate-aws-lambda-deployment-with-sam-cli"><a class="anchor" href="#simulate-aws-lambda-deployment-with-sam-cli"></a>Simular o AWS Lambda Deployment com a CLI do SAM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AWS SAM CLI allows you to run your lambda&#8217;s locally on your laptop in a simulated Lambda environment.  This requires Docker to be installed.
After you have built your Maven project, execute this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sam local start-api --template target/sam.jvm.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will start a Docker container that mimics Amazon&#8217;s Lambda&#8217;s deployment environment. Once the environment
is started you can invoke the example lambda in your browser by going to:</p>
</div>
<div class="paragraph">
<p><a href="http://127.0.0.1:3000/hello" class="bare">http://127.0.0.1:3000/hello</a></p>
</div>
<div class="paragraph">
<p>In the console you&#8217;ll see startup messages from the lambda.  This particular deployment starts a JVM and loads your
lambda as pure Java.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-to-aws"><a class="anchor" href="#deploy-to-aws"></a>Deploy na AWS</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sam deploy -t target/sam.jvm.yaml -g</code></pre>
</div>
</div>
<div class="paragraph">
<p>Answer all the questions and your lambda will be deployed and the necessary hooks to the API Gateway will be set up. If
everything deploys successfully, the root URL of your microservice will be output to the console.  Something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Key                 LambdaHttpApi
Description         URL for application
Value               https://234asdf234as.execute-api.us-east-1.amazonaws.com/</pre>
</div>
</div>
<div class="paragraph">
<p>O atributo <code>Value</code> é o URL raiz do seu lambda. Copie-o para o seu navegador e adicione <code>hello</code> no final.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Responses for binary types will be automatically encoded with base64.  This is different from the behavior using
<code>quarkus:dev</code> which will return the raw bytes.  Amazon&#8217;s API has additional restrictions requiring the base64 encoding.
In general, client code will automatically handle this encoding but in certain custom situations, you should be aware
you may need to manually manage that encoding.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-a-native-executable"><a class="anchor" href="#deploying-a-native-executable"></a>Deploy de um executável nativo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para fazer o deploy de um executável nativo, é necessário compilá-lo com o GraalVM.</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native --no-tests -Dquarkus.native.container-build=true
# The --no-tests flag is required only on Windows and macOS.</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative -DskipTests -Dquarkus.native.container-build=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você pode então testar o executável localmente com sam local</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sam local start-api --template target/sam.native.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para fazer o deploy no AWS Lambda:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sam deploy -t target/sam.native.yaml -g</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examine-the-pom"><a class="anchor" href="#examine-the-pom"></a>Examinando o POM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is nothing special about the POM other than the inclusion of the <code>quarkus-amazon-lambda-http</code> extension
(if you are deploying an AWS Gateway HTTP API) or the <code>quarkus-amazon-lambda-rest</code> extension (if you are deploying an AWS Gateway REST API).
These extensions automatically generate everything you might need for your lambda deployment.</p>
</div>
<div class="paragraph">
<p>Also, at least in the generated Maven archetype <code>pom.xml</code>, the <code>quarkus-rest</code>, <code>quarkus-reactive-routes</code>, and <code>quarkus-undertow</code>
dependencies are all optional.  Pick which HTTP framework(s) you want to use (Jakarta REST, Reactive Routes, and/or Servlet) and
remove the other dependencies to shrink your deployment.</p>
</div>
<div class="sect2">
<h3 id="examine-sam-yaml"><a class="anchor" href="#examine-sam-yaml"></a>Examinando o sam.yaml</h3>
<div class="paragraph">
<p>The <code>sam.yaml</code> syntax is beyond the scope of this document.  There&#8217;s a couple of things that must be highlighted just in case you are
going to craft your own custom <code>sam.yaml</code> deployment files.</p>
</div>
<div class="paragraph">
<p>The first thing to note is that for pure Java lambda deployments require a specific handler class.
Do not change the Lambda handler name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">     Properties:
        Handler: io.quarkus.amazon.lambda.runtime.QuarkusStreamHandler::handleRequest
        Runtime: java17</code></pre>
</div>
</div>
<div class="paragraph">
<p>Este handler é uma ponte entre o tempo de execução do lambda e a estrutura HTTP do Quarkus que está a utilizando (Jakarta REST, Servlet, etc.)</p>
</div>
<div class="paragraph">
<p>If you want to go native, there&#8217;s an environment variable that must be set for native GraalVM deployments.  If you look at <code>sam.native.yaml</code>
you&#8217;ll see this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">        Environment:
          Variables:
            DISABLE_SIGNAL_HANDLERS: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta variável de ambiente resolve algumas incompatibilidades entre o Quarkus e o ambiente AWS Lambda Custom Runtime.</p>
</div>
<div class="paragraph">
<p>Finally, there is one specific thing for AWS Gateway REST API deployments.
That API assumes that HTTP response bodies are text unless you explicitly tell it which media types are
binary through configuration.  To make things easier, the Quarkus extension forces a binary (base 64) encoding of all
HTTP response messages and the <code>sam.yaml</code> file must configure the API Gateway to assume all media types are binary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">  Globals:
    Api:
      EndpointConfiguration: REGIONAL
      BinaryMediaTypes:
        - "*/*"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="injectable-aws-context-variables"><a class="anchor" href="#injectable-aws-context-variables"></a>Variáveis de contexto AWS injetáveis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are using Quarkus REST and Jakarta REST, you can inject various AWS Context variables into your Jakarta REST resource classes
using the Jakarta REST <code>@Context</code> annotation or anywhere else with the CDI <code>@Inject</code> annotation.</p>
</div>
<div class="paragraph">
<p>For the AWS HTTP API you can inject the AWS variables <code>com.amazonaws.services.lambda.runtime.Context</code> and
<code>com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPEvent</code>.  Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.ws.rs.core.Context;
import com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPEvent;


@Path("/myresource")
public class MyResource {
    @GET
    public String ctx(@Context com.amazonaws.services.lambda.runtime.Context ctx) { }

    @GET
    public String event(@Context APIGatewayV2HTTPEvent event) { }

    @GET
    public String requestContext(@Context APIGatewayV2HTTPEvent.RequestContext req) { }


}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the AWS REST API you can inject the AWS variables <code>com.amazonaws.services.lambda.runtime.Context</code> and
<code>io.quarkus.amazon.lambda.http.model.AwsProxyRequestContext</code>.  Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.ws.rs.core.Context;
import io.quarkus.amazon.lambda.http.model.AwsProxyRequestContext;
import io.quarkus.amazon.lambda.http.model.AwsProxyRequest;


@Path("/myresource")
public class MyResource {
    @GET
    public String ctx(@Context com.amazonaws.services.lambda.runtime.Context ctx) { }

    @GET
    public String reqContext(@Context AwsProxyRequestContext req) { }

    @GET
    public String req(@Context AwsProxyRequest req) { }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tracing-with-aws-xray-and-graalvm"><a class="anchor" href="#tracing-with-aws-xray-and-graalvm"></a>Tracing com AWS XRay e GraalVM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Se estiver criando imagens nativas e quiser usar o <a href="https://aws.amazon.com/xray">AWS X-Ray Tracing</a> com seu lambda, será necessário incluir <code>quarkus-amazon-lambda-xray</code> como uma dependência no seu pom. A biblioteca do AWS X-Ray não é totalmente compatível com o GraalVM, portanto, tivemos que fazer algum trabalho de integração para que isso funcionasse.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-integration"><a class="anchor" href="#security-integration"></a>Integração da segurança</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you invoke an HTTP request on the API Gateway, the Gateway turns that HTTP request into a JSON event document that is
forwarded to a Quarkus Lambda.  The Quarkus Lambda parses this json and converts in into an internal representation of an HTTP
request that can be consumed by any HTTP framework Quarkus supports (Jakarta REST, servlet, Reactive Routes).</p>
</div>
<div class="paragraph">
<p>API Gateway supports many ways to securely invoke on your HTTP endpoints that are backed by Lambda and Quarkus.
If you enable it, Quarkus will automatically parse relevant parts of the <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-lambda.html">event json document</a>
and look for security based metadata and register a <code>java.security.Principal</code> internally that can be looked up in Jakarta REST
by injecting a <code>jakarta.ws.rs.core.SecurityContext</code>, via <code>HttpServletRequest.getUserPrincipal()</code> in servlet, and <code>RouteContext.user()</code> in Reactive Routes.
If you want more security information, the <code>Principal</code> object can be typecast to
a class that will give you more information.</p>
</div>
<div class="paragraph">
<p>Para ativar esta funcionalidade de segurança, adicione isto ao seu arquivo <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>quarkus.lambda-http.enable-security=true</pre>
</div>
</div>
<div class="paragraph">
<p>Eis o seu mapa:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. HTTP <code>quarkus-amazon-lambda-http</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Auth Type</th>
<th class="tableblock halign-left valign-top">Classe principal</th>
<th class="tableblock halign-left valign-top">Caminho Json do nome principal</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cognito JWT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.quarkus.amazon.lambda.http.CognitoPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestContext.authorizer.jwt.claims.cognito:username</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.quarkus.amazon.lambda.http.IAMPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestContext.authorizer.iam.userId</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lambda personalizado</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.quarkus.amazon.lambda.http.CustomPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestContext.authorizer.lambda.principalId</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. REST <code>quarkus-amazon-lambda-rest</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Auth Type</th>
<th class="tableblock halign-left valign-top">Classe principal</th>
<th class="tableblock halign-left valign-top">Caminho Json do nome principal</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cognito</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.quarkus.amazon.lambda.http.CognitoPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestContext.authorizer.claims.cognito:username</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.quarkus.amazon.lambda.http.IAMPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestContext.identity.user</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lambda personalizado</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.quarkus.amazon.lambda.http.CustomPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestContext.authorizer.principalId</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the <code>cognito:groups</code> claim is present, then Quarkus will extract and map those groups
to Quarkus roles which can then be used in authorization with annotations like <code>@RolesAllowed</code>.
If you do not want to map <code>cognito:groups</code> to Quarkus roles, then you must explicitly disable it
in configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>quarkus.lambda-http.map-cognito-to-roles=false</pre>
</div>
</div>
<div class="paragraph">
<p>Você também pode especificar uma reivindicação do Cognito diferente para extrair funções:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>quarkus.lambda-http.cognito-role-claim=cognito:roles</pre>
</div>
</div>
<div class="paragraph">
<p>By default, it expects roles in a space delimited list enclosed in brackets i.e. <code>[ user admin ]</code>.
You can specify the regular expression to use to find individual roles in the claim string too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>quarkus.lambda-http.cognito-claim-matcher=[^\[\] \t]+</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom-security-integration"><a class="anchor" href="#custom-security-integration"></a>Integração de segurança personalizada</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default support for AWS security only maps the principal name to Quarkus security
APIs and does nothing to map claims or roles or permissions.  You have full control on
how security metadata in the lambda HTTP event is mapped to Quarkus Security APIs using
implementations of the <code>io.quarkus.amazon.lambda.http.LambdaIdentityProvider</code>
interface.  By implementing this interface, you can do things like define role mappings for your principal
or publish additional attributes provided by IAM or Cognito or your Custom Lambda security integration.</p>
</div>
<div class="listingblock">
<div class="title">HTTP <code>quarkus-amazon-lambda-http</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.quarkus.amazon.lambda.http;

/**
 * Helper interface that removes some boilerplate for creating
 * an IdentityProvider that processes APIGatewayV2HTTPEvent
 */
public interface LambdaIdentityProvider extends IdentityProvider&lt;LambdaAuthenticationRequest&gt; {
    @Override
    default public Class&lt;LambdaAuthenticationRequest&gt; getRequestType() {
        return LambdaAuthenticationRequest.class;
    }

    @Override
    default Uni&lt;SecurityIdentity&gt; authenticate(LambdaAuthenticationRequest request, AuthenticationRequestContext context) {
        APIGatewayV2HTTPEvent event = request.getEvent();
        SecurityIdentity identity = authenticate(event);
        if (identity == null) {
            return Uni.createFrom().optional(Optional.empty());
        }
        return Uni.createFrom().item(identity);
    }

    /**
     * You must override this method unless you directly override
     * IdentityProvider.authenticate
     *
     * @param event
     * @return
     */
    default SecurityIdentity authenticate(APIGatewayV2HTTPEvent event) {
        throw new IllegalStateException("You must override this method or IdentityProvider.authenticate");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For HTTP, the important method to override is <code>LambdaIdentityProvider.authenticate(APIGatewayV2HTTPEvent event)</code>.  From this
you will allocate a SecurityIdentity based on how you want to map security data from <code>APIGatewayV2HTTPEvent</code></p>
</div>
<div class="listingblock">
<div class="title">REST <code>quarkus-amazon-lambda-rest</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.quarkus.amazon.lambda.http;

import java.util.Optional;

import com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPEvent;

import io.quarkus.amazon.lambda.http.model.AwsProxyRequest;
import io.quarkus.security.identity.AuthenticationRequestContext;
import io.quarkus.security.identity.IdentityProvider;
import io.quarkus.security.identity.SecurityIdentity;
import io.smallrye.mutiny.Uni;

/**
 * Helper interface that removes some boilerplate for creating
 * an IdentityProvider that processes APIGatewayV2HTTPEvent
 */
public interface LambdaIdentityProvider extends IdentityProvider&lt;LambdaAuthenticationRequest&gt; {
...

    /**
     * You must override this method unless you directly override
     * IdentityProvider.authenticate
     *
     * @param event
     * @return
     */
    default SecurityIdentity authenticate(AwsProxyRequest event) {
        throw new IllegalStateException("You must override this method or IdentityProvider.authenticate");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For REST, the important method to override is <code>LambdaIdentityProvider.authenticate(AwsProxyRequest event)</code>.  From this
you will allocate a SecurityIdentity based on how you want to map security data from <code>AwsProxyRequest</code>.</p>
</div>
<div class="paragraph">
<p>O seu provider implementado deve ser um bean CDI. Eis um exemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme;

import java.security.Principal;

import jakarta.enterprise.context.ApplicationScoped;

import com.amazonaws.services.lambda.runtime.events.APIGatewayV2HTTPEvent;

import io.quarkus.amazon.lambda.http.LambdaIdentityProvider;
import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.runtime.QuarkusPrincipal;
import io.quarkus.security.runtime.QuarkusSecurityIdentity;

@ApplicationScoped
public class CustomSecurityProvider implements LambdaIdentityProvider {
    @Override
    public SecurityIdentity authenticate(APIGatewayV2HTTPEvent event) {
        if (event.getHeaders() == null || !event.getHeaders().containsKey("x-user"))
            return null;
        Principal principal = new QuarkusPrincipal(event.getHeaders().get("x-user"));
        QuarkusSecurityIdentity.Builder builder = QuarkusSecurityIdentity.builder();
        builder.setPrincipal(principal);
        return builder.build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Aqui está o mesmo exemplo, mas com a API REST do AWS Gateway:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme;

import java.security.Principal;

import jakarta.enterprise.context.ApplicationScoped;

import io.quarkus.amazon.lambda.http.model.AwsProxyRequest;

import io.quarkus.amazon.lambda.http.LambdaIdentityProvider;
import io.quarkus.security.identity.SecurityIdentity;
import io.quarkus.security.runtime.QuarkusPrincipal;
import io.quarkus.security.runtime.QuarkusSecurityIdentity;

@ApplicationScoped
public class CustomSecurityProvider implements LambdaIdentityProvider {
    @Override
    public SecurityIdentity authenticate(AwsProxyRequest event) {
        if (event.getMultiValueHeaders() == null || !event.getMultiValueHeaders().containsKey("x-user"))
            return null;
        Principal principal = new QuarkusPrincipal(event.getMultiValueHeaders().getFirst("x-user"));
        QuarkusSecurityIdentity.Builder builder = QuarkusSecurityIdentity.builder();
        builder.setPrincipal(principal);
        return builder.build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus should automatically discover this implementation and use it instead of the default implementation
discussed earlier.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simple-sam-local-principal"><a class="anchor" href="#simple-sam-local-principal"></a>Principal local SAM simples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are testing your application with <code>sam local</code> you can
hardcode a principal name to use when your application runs by setting
the <code>QUARKUS_AWS_LAMBDA_FORCE_USER_NAME</code> environment variable</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="snapstart"><a class="anchor" href="#snapstart"></a>SnapStart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para otimizar a sua aplicação para o Lambda SnapStart, consulte a <a href="amazon-snapstart.html">documentação de configuração do SnapStart</a>.</p>
</div>
</div>
</div>
        </div>
        <div class="grid__item width-4-12 width-12-12-m tocwrapper">
            <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#prerequisites">Pré-requisitos</a></li>
<li><a href="#getting-started">Primeiros passos</a></li>
<li><a href="#installing-aws-bits">Instalando os componentes AWS</a></li>
<li><a href="#creating-the-maven-deployment-project">Criando o Maven Deployment Project</a></li>
<li><a href="#build-and-deploy">Build e Deploy</a></li>
<li><a href="#extra-build-generated-files">Arquivos extras gerados pela compilação</a></li>
<li><a href="#live-coding-and-simulating-aws-lambda-environment-locally">Live Coding e simulação local do ambiente AWS Lambda</a></li>
<li><a href="#simulate-aws-lambda-deployment-with-sam-cli">Simular o AWS Lambda Deployment com a CLI do SAM</a></li>
<li><a href="#deploy-to-aws">Deploy na AWS</a></li>
<li><a href="#deploying-a-native-executable">Deploy de um executável nativo</a></li>
<li><a href="#examine-the-pom">Examinando o POM</a>
<ul class="sectlevel2">
<li><a href="#examine-sam-yaml">Examinando o sam.yaml</a></li>
</ul>
</li>
<li><a href="#injectable-aws-context-variables">Variáveis de contexto AWS injetáveis</a></li>
<li><a href="#tracing-with-aws-xray-and-graalvm">Tracing com AWS XRay e GraalVM</a></li>
<li><a href="#security-integration">Integração da segurança</a></li>
<li><a href="#custom-security-integration">Integração de segurança personalizada</a></li>
<li><a href="#simple-sam-local-principal">Principal local SAM simples</a></li>
<li><a href="#snapstart">SnapStart</a></li>
</ul></div>
        </div>
    </div>
    <h2>Conteúdo Relacionado</h2>
    <div class="grid-wrapper relations">
        <div class="grid__item width-6-12 width-12-12-m">
            <h3>Nas mesmas extensões</h3>
            <ul class="related-content">
                
                
                <li class="guide"><a href="/version/3.20/guides/aws-lambda">AWS Lambda</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-aws-lambda-http">Vinculação HTTP do Funqy com o AWS Lambda</a></li>
                </ul>
        </div>
        <div class="grid__item width-6-12 width-12-12-m">
            <h3>Nos mesmos tópicos</h3>
            <ul class="related-content">
                
                
                <li class="guide"><a href="/version/3.20/guides/aws-lambda">AWS Lambda</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/aws-lambda-snapstart">Configuração do AWS Lambda SnapStart</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-aws-lambda">Funqy AWS Lambda Binding</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-aws-lambda-http">Vinculação HTTP do Funqy com o AWS Lambda</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/azure-functions">Azure Functions</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/azure-functions-http">Azure Functions with Quarkus REST, Undertow, or Reactive Routes</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy">Funqy</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-gcp-functions">Funqy Google Cloud Functions</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-http">Funqy HTTP Binding (Standalone)</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-azure-functions-http">Vinculação HTTP do Funqy com o Azure Functions</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-gcp-functions-http">Integração HTTP do Funqy com o Google Cloud Functions</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/funqy-knative-events">Funqy Knative Events Binding</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/gcp-functions">Google Cloud Functions (Serverless)</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/gcp-functions-http">Google Cloud Functions (Serverless) with Quarkus REST, Undertow, or Reactive Routes</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/appcds">AppCDS</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/container-image">Container Images</a></li>
                
                
                <li class="howto"><a href="/version/3.20/guides/deploying-to-openshift-native-howto">Deploying Quarkus applications compiled to native executables</a></li>
                
                
                <li class="guide"><a href="/version/3.20/guides/deploying-to-openshift">Deploying Quarkus applications to OpenShift</a></li>
                
                
                <li class="howto"><a href="/version/3.20/guides/deploying-to-openshift-howto">Deploying Quarkus applications to OpenShift in a single step</a></li>
                
                
                <li class="howto"><a href="/version/3.20/guides/deploying-to-openshift-docker-howto">Deploying Quarkus Java applications to OpenShift by using a Docker build strategy</a></li>
                </ul>
        </div>
        </div>
    </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license. <i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-by'></i> <a href='https://creativecommons.org/licenses/by/3.0/' target='_blank'>CC by 3.0</a><br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">Home</a></li>
          
          
          
            <li><a href="/about" target="_blank">About</a></li>
          
          
          
            <li><a href="/blog" target="_blank">Blog</a></li>
          
          
          
            <li><a href="/insights" target="_blank">Podcast</a></li>
          
          
          
            <li><a href="/events" target="_blank">Eventos</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">Newsletter</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">User Stories</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">Roadmap</a></li>
          
          
          
            <li><a href="/security" target="_blank">Security&nbsp;policy</a></li>
          
          
          
            <li><a href="/usage" target="_blank">Usage</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
          
            <li><a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy Policy</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Follow Us</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.threads.com/@quarkusio" target="_blank">Threads</a></li>
          
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">Support</a></li>
          
          
          
            <li><a href="/guides" target="_blank">Guias</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">Get Started</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">Discussions</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">Development mailing list</a></li>
          
          
          
            <li><a href="https://stats.uptimerobot.com/ze1PfweT2p" target="_blank">Quarkus Service Status</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
          
            <li><a href="https://quarkus.io/" target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href="https://es.quarkus.io/" target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href="https://ja.quarkus.io/" target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content cf-footer">
  <div class="flexcontainer">
    <div class="cf-logo">
      <a class="cf-logo" href="https://www.commonhaus.org/" target="_blank"><img src="https://raw.githubusercontent.com/commonhaus/artwork/main/foundation/brand/svg/CF_logo_horizontal_single_reverse.svg"/></a>
    </div>
    <div class="license">
      Copyright © Quarkus. All rights reserved. For details on our trademarks, please visit our <a href="https://www.commonhaus.org/policies/trademark-policy/">Trademark Policy</a> and <a href="https://www.commonhaus.org/trademarks/">Trademark List</a>. Trademarks of third parties are owned by their respective holders and their mention here does not suggest any endorsement or association.
    </div>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
  <script src="/assets/javascript/randomize.js" type="text/javascript"></script>
  <script src="/assets/javascript/time.js" type="text/javascript"></script>
</body>

</html>
